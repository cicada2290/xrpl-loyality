# インセンティブシステム仕様書

## 1. システム概要 🎯

### 1.1 目的
従業員のNFTミントと独自トークンの取引を通じて、インセンティブを付与するシステム

### 1.2 アカウント構成

| アカウント種別 | 役割 |
|------------|------|
| 企業ウォレット | - NFTのIssuer<br>- 独自トークンの発行者<br>- XRP支払いの実行 |
| 従業員ウォレット | - NFTのミント実行<br>- 独自トークンの保有<br>- XRPの受取 |

## 2. トランザクションフロー 🔄

### 2.1 処理シーケンス

1. 従業員がNFTをミント
2. 企業が従業員に独自トークンを支給
3. 従業員が企業に独自トークンを送金
4. 条件を満たした場合、企業からXRPが支払われる

## 3. Hook仕様 💫

### 3.1 基本情報
- **プラットフォーム**: Xahau Network
- **開発言語**: Rust
- **開発ツール**: hooks-toolkit

### 3.2 Hook処理フロー

#### NFTokenMint処理
1. トランザクション受信
2. トランザクションタイプの確認（NFTokenMint）
3. Issuerの検証（企業ウォレットアドレス）
4. ミント実行者の検証（従業員ウォレット）
5. 承認/拒否の判定

#### Payment処理
1. トランザクション受信
2. トランザクションタイプの確認（Payment）
3. 送金トークンの検証（指定された独自トークン）
4. 送金元アカウントの検証（従業員ウォレット）
5. 送金先アカウントの検証（企業ウォレット）
6. 条件確認
   - 送金額の確認
   - その他の条件確認
7. 条件を満たす場合、XRP支払いのエミット

#### エラーハンドリング
- 不正なIssuer → 拒否
- 不正な送金元/送金先 → 拒否
- 条件不一致 → 拒否
- その他のトランザクション → 承認

### 3.3 実装項目
- [ ] トランザクションタイプの判定
- [ ] NFTミントの検証
- [ ] トークン送金の検証
- [ ] XRP支払い条件の確認
- [ ] XRP支払いの実行

## 4. 技術要件 🛠️

### 4.1 開発環境
- Rust
- hooks-toolkit
- xahaud

### 4.2 テスト環境
- hooks-testnet
- テストアカウント

## 5. セキュリティ要件 🔒

### 5.1 検証項目
- Issuerの正当性確認
- トランザクション署名の検証
- 不正アクセスの防止

### 5.2 エラーハンドリング
- 不正トランザクションの拒否
- エラーログの記録

## 6. 未決定事項 ❓

### 6.1 NFT関連
- ミントの条件設定
- 1人あたりの発行上限
- メタデータの要件

### 6.2 独自トークン関連
- トークン名（CurrencyCode）
- 従業員への配布量
- 利用期限の有無

### 6.3 XRP支払い関連
- 支払い条件（必要トークン量）
- 支払いXRP量
- 支払い頻度の制限

## 7. 今後の課題 📝
- [ ] 具体的な条件値の設定
- [ ] テストシナリオの作成
- [ ] 運用フローの確立 